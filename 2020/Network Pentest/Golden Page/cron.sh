#!/bin/bash

set -x

UPLOAD_DIRECTORY=/var/backups/uploads
EXT=png
HEALTH=30

if [[ -z $UPLOAD_DIRECTORY || -z $EXT || -z $HEALTH ]]; then
  echo 'one or more variables are undefined'
  exit 1
fi

find $UPLOAD_DIRECTORY -name "*.$EXT" -type f -mtime +$HEALTH | grep .

if [ $? -ne 0 ];
then
        echo -e "No old files found :( \n\n"
else
        /usr/share/misc/remove_script/remove.sh `find $UPLOAD_DIRECTORY -name "*.$EXT" -type f -mtime +$HEALTH`
        echo -e "Deleted images that are older than 30 days\n\n"
fi